esphome:
  name: teltonika-gateway
  friendly_name: Teltonika EYE Gateway
  comment: ESP32 BLE bridge for Teltonika EYE sensors

esp32:
  board: esp32dev
  framework:
    type: arduino

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  ap:
    ssid: "Teltonika Fallback"
    password: "changeme123"

captive_portal:

logger:
  level: DEBUG
  logs:
    teltonika_ble: DEBUG
    esp32_ble_tracker: DEBUG

api:

ota:
  - platform: esphome
    id: ota_esphome

web_server:
  port: 80

time:
  - platform: sntp
    id: sntp_time

esp32_ble_tracker:
  scan_parameters:
    interval: 320ms
    window: 30ms
    active: false

external_components:
  - source: github://VignanTej/teltonika-eye-homeassistant
    components:
      - teltonika_ble
    refresh: 0s

teltonika_ble:
  id: teltonika_ble_component
  discover: true
  timeout: 300s

# Sensor definitions using the teltonika_ble platform
sensor:
  # Device 1: 7C:D9:F4:13:BD:BF
  - platform: teltonika_ble
    teltonika_ble_id: teltonika_ble_component
    mac_address: "7C:D9:F4:13:BD:BF"
    temperature:
      name: "Teltonika EYE 1 Temperature"
    humidity:
      name: "Teltonika EYE 1 Humidity"
    movement_count:
      name: "Teltonika EYE 1 Movement Count"
    pitch:
      name: "Teltonika EYE 1 Pitch"
    roll:
      name: "Teltonika EYE 1 Roll"
    battery_voltage:
      name: "Teltonika EYE 1 Battery Voltage"
    battery_level:
      name: "Teltonika EYE 1 Battery Level"
    rssi:
      name: "Teltonika EYE 1 RSSI"

  # Device 2: 7C:D9:F4:14:21:5D
  - platform: teltonika_ble
    teltonika_ble_id: teltonika_ble_component
    mac_address: "7C:D9:F4:14:21:5D"
    temperature:
      name: "Teltonika EYE 2 Temperature"
    humidity:
      name: "Teltonika EYE 2 Humidity"
    movement_count:
      name: "Teltonika EYE 2 Movement Count"
    pitch:
      name: "Teltonika EYE 2 Pitch"
    roll:
      name: "Teltonika EYE 2 Roll"
    battery_voltage:
      name: "Teltonika EYE 2 Battery Voltage"
    battery_level:
      name: "Teltonika EYE 2 Battery Level"
    rssi:
      name: "Teltonika EYE 2 RSSI"

binary_sensor:
  # Device 1: 7C:D9:F4:13:BD:BF
  - platform: teltonika_ble
    teltonika_ble_id: teltonika_ble_component
    mac_address: "7C:D9:F4:13:BD:BF"
    movement:
      name: "Teltonika EYE 1 Movement"
    magnetic:
      name: "Teltonika EYE 1 Magnetic Field"
    low_battery:
      name: "Teltonika EYE 1 Low Battery"

  # Device 2: 7C:D9:F4:14:21:5D
  - platform: teltonika_ble
    teltonika_ble_id: teltonika_ble_component
    mac_address: "7C:D9:F4:14:21:5D"
    movement:
      name: "Teltonika EYE 2 Movement"
    magnetic:
      name: "Teltonika EYE 2 Magnetic Field"
    low_battery:
      name: "Teltonika EYE 2 Low Battery"